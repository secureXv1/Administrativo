import{c as d,o as u,r as $,a as i,b as vt,d as Ne,e as f,w as se,f as A,v as ce,T as qe,g as F,h as O,n as Ce,i as M,t as m,F as x,j as P,k as _,l as mt,_ as gt,m as I,p as D,u as ft,q as X,s as yt,x as Fe,y as bt,z as Q,A as le,B as St,C as It,D as U,E as Ee,G as Ot,H as Ct}from"./index-BwLKGDxz.js";function we(e){return e===0?!1:Array.isArray(e)&&e.length===0?!0:!e}function Et(e){return(...a)=>!e(...a)}function wt(e,a){return e===void 0&&(e="undefined"),e===null&&(e="null"),e===!1&&(e="false"),e.toString().toLowerCase().indexOf(a.trim())!==-1}function kt(e){return e.filter(a=>!a.$isLabel)}function ke(e,a){return n=>n.reduce((b,y)=>y[e]&&y[e].length?(b.push({$groupLabel:y[a],$isLabel:!0}),b.concat(y[e])):b,[])}const He=(...e)=>a=>e.reduce((n,b)=>b(n),a);var Nt={data(){return{search:"",isOpen:!1,preferredOpenDirection:"below",optimizedHeight:this.maxHeight}},props:{internalSearch:{type:Boolean,default:!0},options:{type:Array,required:!0},multiple:{type:Boolean,default:!1},trackBy:{type:String},label:{type:String},searchable:{type:Boolean,default:!0},clearOnSelect:{type:Boolean,default:!0},hideSelected:{type:Boolean,default:!1},placeholder:{type:String,default:"Select option"},allowEmpty:{type:Boolean,default:!0},resetAfter:{type:Boolean,default:!1},closeOnSelect:{type:Boolean,default:!0},customLabel:{type:Function,default(e,a){return we(e)?"":a?e[a]:e}},taggable:{type:Boolean,default:!1},tagPlaceholder:{type:String,default:"Press enter to create a tag"},tagPosition:{type:String,default:"top"},max:{type:[Number,Boolean],default:!1},id:{default:null},optionsLimit:{type:Number,default:1e3},groupValues:{type:String},groupLabel:{type:String},groupSelect:{type:Boolean,default:!1},blockKeys:{type:Array,default(){return[]}},preserveSearch:{type:Boolean,default:!1},preselectFirst:{type:Boolean,default:!1},preventAutofocus:{type:Boolean,default:!1},filteringSortFunc:{type:Function,default:null}},mounted(){!this.multiple&&this.max&&console.warn("[Vue-Multiselect warn]: Max prop should not be used when prop Multiple equals false."),this.preselectFirst&&!this.internalValue.length&&this.options.length&&this.select(this.filteredOptions[0])},computed:{internalValue(){return this.modelValue||this.modelValue===0?Array.isArray(this.modelValue)?this.modelValue:[this.modelValue]:[]},filteredOptions(){const e=this.search||"",a=e.toLowerCase().trim();let n=this.options.concat();return this.internalSearch?n=this.groupValues?this.filterAndFlat(n,a,this.label):this.filterOptions(n,a,this.label,this.customLabel):n=this.groupValues?ke(this.groupValues,this.groupLabel)(n):n,n=this.hideSelected?n.filter(Et(this.isSelected)):n,this.taggable&&a.length&&!this.isExistingOption(a)&&(this.tagPosition==="bottom"?n.push({isTag:!0,label:e}):n.unshift({isTag:!0,label:e})),n.slice(0,this.optionsLimit)},valueKeys(){return this.trackBy?this.internalValue.map(e=>e[this.trackBy]):this.internalValue},optionKeys(){return(this.groupValues?this.flatAndStrip(this.options):this.options).map(a=>this.customLabel(a,this.label).toString().toLowerCase())},currentOptionLabel(){return this.multiple?this.searchable?"":this.placeholder:this.internalValue.length?this.getOptionLabel(this.internalValue[0]):this.searchable?"":this.placeholder}},watch:{internalValue:{handler(){this.resetAfter&&this.internalValue.length&&(this.search="",this.$emit("update:modelValue",this.multiple?[]:null))},deep:!0},search(){this.$emit("search-change",this.search)}},emits:["open","search-change","close","select","update:modelValue","remove","tag"],methods:{getValue(){return this.multiple?this.internalValue:this.internalValue.length===0?null:this.internalValue[0]},filterAndFlat(e,a,n){return He(this.filterGroups(a,n,this.groupValues,this.groupLabel,this.customLabel),ke(this.groupValues,this.groupLabel))(e)},flatAndStrip(e){return He(ke(this.groupValues,this.groupLabel),kt)(e)},updateSearch(e){this.search=e},isExistingOption(e){return this.options?this.optionKeys.indexOf(e)>-1:!1},isSelected(e){const a=this.trackBy?e[this.trackBy]:e;return this.valueKeys.indexOf(a)>-1},isOptionDisabled(e){return!!e.$isDisabled},getOptionLabel(e){if(we(e))return"";if(e.isTag)return e.label;if(e.$isLabel)return e.$groupLabel;const a=this.customLabel(e,this.label);return we(a)?"":a},select(e,a){if(e.$isLabel&&this.groupSelect){this.selectGroup(e);return}if(!(this.blockKeys.indexOf(a)!==-1||this.disabled||e.$isDisabled||e.$isLabel)&&!(this.max&&this.multiple&&this.internalValue.length===this.max)&&!(a==="Tab"&&!this.pointerDirty)){if(e.isTag)this.$emit("tag",e.label,this.id),this.search="",this.closeOnSelect&&!this.multiple&&this.deactivate();else{if(this.isSelected(e)){a!=="Tab"&&this.removeElement(e);return}this.multiple?this.$emit("update:modelValue",this.internalValue.concat([e])):this.$emit("update:modelValue",e),this.$emit("select",e,this.id),this.clearOnSelect&&(this.search="")}this.closeOnSelect&&this.deactivate()}},selectGroup(e){const a=this.options.find(n=>n[this.groupLabel]===e.$groupLabel);if(a){if(this.wholeGroupSelected(a)){this.$emit("remove",a[this.groupValues],this.id);const n=this.trackBy?a[this.groupValues].map(y=>y[this.trackBy]):a[this.groupValues],b=this.internalValue.filter(y=>n.indexOf(this.trackBy?y[this.trackBy]:y)===-1);this.$emit("update:modelValue",b)}else{const n=a[this.groupValues].filter(b=>!(this.isOptionDisabled(b)||this.isSelected(b)));this.max&&n.splice(this.max-this.internalValue.length),this.$emit("select",n,this.id),this.$emit("update:modelValue",this.internalValue.concat(n))}this.closeOnSelect&&this.deactivate()}},wholeGroupSelected(e){return e[this.groupValues].every(a=>this.isSelected(a)||this.isOptionDisabled(a))},wholeGroupDisabled(e){return e[this.groupValues].every(this.isOptionDisabled)},removeElement(e,a=!0){if(this.disabled||e.$isDisabled)return;if(!this.allowEmpty&&this.internalValue.length<=1){this.deactivate();return}const n=typeof e=="object"?this.valueKeys.indexOf(e[this.trackBy]):this.valueKeys.indexOf(e);if(this.multiple){const b=this.internalValue.slice(0,n).concat(this.internalValue.slice(n+1));this.$emit("update:modelValue",b)}else this.$emit("update:modelValue",null);this.$emit("remove",e,this.id),this.closeOnSelect&&a&&this.deactivate()},removeLastElement(){this.blockKeys.indexOf("Delete")===-1&&this.search.length===0&&Array.isArray(this.internalValue)&&this.internalValue.length&&this.removeElement(this.internalValue[this.internalValue.length-1],!1)},activate(){this.isOpen||this.disabled||(this.adjustPosition(),this.groupValues&&this.pointer===0&&this.filteredOptions.length&&(this.pointer=1),this.isOpen=!0,this.searchable?(this.preserveSearch||(this.search=""),this.preventAutofocus||this.$nextTick(()=>this.$refs.search&&this.$refs.search.focus())):this.preventAutofocus||typeof this.$el<"u"&&this.$el.focus(),this.$emit("open",this.id))},deactivate(){this.isOpen&&(this.isOpen=!1,this.searchable?this.$refs.search!==null&&typeof this.$refs.search<"u"&&this.$refs.search.blur():typeof this.$el<"u"&&this.$el.blur(),this.preserveSearch||(this.search=""),this.$emit("close",this.getValue(),this.id))},toggle(){this.isOpen?this.deactivate():this.activate()},adjustPosition(){if(typeof window>"u")return;const e=this.$el.getBoundingClientRect().top,a=window.innerHeight-this.$el.getBoundingClientRect().bottom;a>this.maxHeight||a>e||this.openDirection==="below"||this.openDirection==="bottom"?(this.preferredOpenDirection="below",this.optimizedHeight=Math.min(a-40,this.maxHeight)):(this.preferredOpenDirection="above",this.optimizedHeight=Math.min(e-40,this.maxHeight))},filterOptions(e,a,n,b){return a?e.filter(y=>wt(b(y,n),a)).sort((y,p)=>typeof this.filteringSortFunc=="function"?this.filteringSortFunc(y,p):b(y,n).length-b(p,n).length):e},filterGroups(e,a,n,b,y){return p=>p.map(o=>{if(!o[n])return console.warn("Options passed to vue-multiselect do not contain groups, despite the config."),[];const E=this.filterOptions(o[n],e,a,y);return E.length?{[b]:o[b],[n]:E}:[]})}}},Dt={data(){return{pointer:0,pointerDirty:!1}},props:{showPointer:{type:Boolean,default:!0},optionHeight:{type:Number,default:40}},computed:{pointerPosition(){return this.pointer*this.optionHeight},visibleElements(){return this.optimizedHeight/this.optionHeight}},watch:{filteredOptions(){this.pointerAdjust()},isOpen(){this.pointerDirty=!1},pointer(){this.$refs.search&&this.$refs.search.setAttribute("aria-activedescendant",this.id+"-"+this.pointer.toString())}},methods:{optionHighlight(e,a){return{"multiselect__option--highlight":e===this.pointer&&this.showPointer,"multiselect__option--selected":this.isSelected(a)}},groupHighlight(e,a){if(!this.groupSelect)return["multiselect__option--disabled",{"multiselect__option--group":a.$isLabel}];const n=this.options.find(b=>b[this.groupLabel]===a.$groupLabel);return n&&!this.wholeGroupDisabled(n)?["multiselect__option--group",{"multiselect__option--highlight":e===this.pointer&&this.showPointer},{"multiselect__option--group-selected":this.wholeGroupSelected(n)}]:"multiselect__option--disabled"},addPointerElement({key:e}="Enter"){this.filteredOptions.length>0&&this.select(this.filteredOptions[this.pointer],e),this.pointerReset()},pointerForward(){this.pointer<this.filteredOptions.length-1&&(this.pointer++,this.$refs.list?.scrollTop<=this.pointerPosition-(this.visibleElements-1)*this.optionHeight&&(this.$refs.list.scrollTop=this.pointerPosition-(this.visibleElements-1)*this.optionHeight),this.filteredOptions[this.pointer]&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerForward()),this.pointerDirty=!0},pointerBackward(){this.pointer>0?(this.pointer--,this.$refs.list?.scrollTop>=this.pointerPosition&&(this.$refs.list.scrollTop=this.pointerPosition),this.filteredOptions[this.pointer]&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerBackward()):this.filteredOptions[this.pointer]&&this.filteredOptions[0].$isLabel&&!this.groupSelect&&this.pointerForward(),this.pointerDirty=!0},pointerReset(){this.closeOnSelect&&(this.pointer=0,this.$refs.list&&(this.$refs.list.scrollTop=0))},pointerAdjust(){this.pointer>=this.filteredOptions.length-1&&(this.pointer=this.filteredOptions.length?this.filteredOptions.length-1:0),this.filteredOptions.length>0&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerForward()},pointerSet(e){this.pointer=e,this.pointerDirty=!0}}},Ge={name:"vue-multiselect",mixins:[Nt,Dt],compatConfig:{MODE:3,ATTR_ENUMERATED_COERCION:!1},props:{name:{type:String,default:""},modelValue:{type:null,default(){return[]}},selectLabel:{type:String,default:"Press enter to select"},selectGroupLabel:{type:String,default:"Press enter to select group"},selectedLabel:{type:String,default:"Selected"},deselectLabel:{type:String,default:"Press enter to remove"},deselectGroupLabel:{type:String,default:"Press enter to deselect group"},showLabels:{type:Boolean,default:!0},limit:{type:Number,default:99999},maxHeight:{type:Number,default:300},limitText:{type:Function,default:e=>`and ${e} more`},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},spellcheck:{type:Boolean,default:!1},openDirection:{type:String,default:""},showNoOptions:{type:Boolean,default:!0},showNoResults:{type:Boolean,default:!0},tabindex:{type:Number,default:0},required:{type:Boolean,default:!1},useTeleport:{type:Boolean,default:!1}},data(){return{dropdownStyles:{},ready:!1}},computed:{hasOptionGroup(){return this.groupValues&&this.groupLabel&&this.groupSelect},isSingleLabelVisible(){return(this.singleValue||this.singleValue===0)&&(!this.isOpen||!this.searchable)&&!this.visibleValues.length},isPlaceholderVisible(){return!this.internalValue.length&&(!this.searchable||!this.isOpen)},visibleValues(){return this.multiple?this.internalValue.slice(0,this.limit):[]},singleValue(){return this.internalValue[0]},deselectLabelText(){return this.showLabels?this.deselectLabel:""},deselectGroupLabelText(){return this.showLabels?this.deselectGroupLabel:""},selectLabelText(){return this.showLabels?this.selectLabel:""},selectGroupLabelText(){return this.showLabels?this.selectGroupLabel:""},selectedLabelText(){return this.showLabels?this.selectedLabel:""},inputStyle(){return this.searchable||this.multiple&&this.modelValue&&this.modelValue.length?this.isOpen?{width:"100%"}:{width:"0",position:"absolute",padding:"0"}:""},contentStyle(){return this.options.length?{display:"inline-block"}:{display:"block"}},isAbove(){return this.openDirection==="above"||this.openDirection==="top"?!0:this.openDirection==="below"||this.openDirection==="bottom"?!1:this.preferredOpenDirection==="above"},showSearchInput(){return this.searchable&&(this.hasSingleSelectedSlot&&(this.visibleSingleValue||this.visibleSingleValue===0)?this.isOpen:!0)},isRequired(){return this.required===!1?!1:this.internalValue.length<=0}},watch:{isOpen(e){e&&(this.useTeleport?(this.ready=!1,this.$nextTick(()=>{const a=this.$el.getBoundingClientRect();this.dropdownStyles={position:"absolute",top:`${a.bottom+window.scrollY}px`,left:`${a.left+window.scrollX}px`,width:`${a.width}px`,zIndex:9999},this.ready=!0})):this.ready=!0)}}};const xt=["tabindex","aria-expanded","aria-owns","aria-activedescendant"],At={ref:"tags",class:"multiselect__tags"},Vt={class:"multiselect__tags-wrap"},Lt=["textContent"],$t=["onKeypress","onMousedown"],Rt=["textContent"],Mt={class:"multiselect__spinner"},_t=["name","id","spellcheck","placeholder","required","value","disabled","tabindex","aria-label","aria-controls"],Tt=["id","aria-multiselectable"],Bt={key:0},Ut={class:"multiselect__option"},Pt=["aria-selected","id","role"],qt=["onClick","onMouseenter","data-select","data-selected","data-deselect"],Ft=["data-select","data-deselect","onMouseenter","onMousedown"],Ht={class:"multiselect__option"},Gt={class:"multiselect__option"};function zt(e,a,n,b,y,p){return u(),d("div",{tabindex:e.searchable?-1:n.tabindex,class:_([{"multiselect--active":e.isOpen,"multiselect--disabled":n.disabled,"multiselect--above":p.isAbove,"multiselect--has-options-group":p.hasOptionGroup},"multiselect"]),onFocus:a[14]||(a[14]=o=>e.activate()),onBlur:a[15]||(a[15]=o=>e.searchable?!1:e.deactivate()),onKeydown:[a[16]||(a[16]=F(O(o=>e.pointerForward(),["self","prevent"]),["down"])),a[17]||(a[17]=F(O(o=>e.pointerBackward(),["self","prevent"]),["up"]))],onKeypress:a[18]||(a[18]=F(O(o=>e.addPointerElement(o),["stop","self"]),["enter","tab"])),onKeyup:a[19]||(a[19]=F(o=>e.deactivate(),["esc"])),role:"combobox","aria-expanded":e.isOpen,"aria-owns":"listbox-"+e.id,"aria-activedescendant":e.isOpen&&e.pointer!==null?e.id+"-"+e.pointer:null},[$(e.$slots,"caret",{toggle:e.toggle},()=>[i("div",{onMousedown:a[0]||(a[0]=O(o=>e.toggle(),["prevent","stop"])),class:"multiselect__select"},null,32)]),$(e.$slots,"clear",{search:e.search}),i("div",At,[$(e.$slots,"selection",{search:e.search,remove:e.removeElement,values:p.visibleValues,isOpen:e.isOpen},()=>[A(i("div",Vt,[(u(!0),d(x,null,P(p.visibleValues,(o,E)=>$(e.$slots,"tag",{option:o,search:e.search,remove:e.removeElement},()=>[(u(),d("span",{class:"multiselect__tag",key:E,onMousedown:a[1]||(a[1]=O(()=>{},["prevent"]))},[i("span",{textContent:m(e.getOptionLabel(o))},null,8,Lt),i("i",{tabindex:"1",onKeypress:F(O(T=>e.removeElement(o),["prevent"]),["enter"]),onMousedown:O(T=>e.removeElement(o),["prevent"]),class:"multiselect__tag-icon"},null,40,$t)],32))])),256))],512),[[ce,p.visibleValues.length>0]]),e.internalValue&&e.internalValue.length>n.limit?$(e.$slots,"limit",{key:0},()=>[i("strong",{class:"multiselect__strong",textContent:m(n.limitText(e.internalValue.length-n.limit))},null,8,Rt)]):f("v-if",!0)]),Ne(qe,{name:"multiselect__loading"},{default:se(()=>[$(e.$slots,"loading",{},()=>[A(i("div",Mt,null,512),[[ce,n.loading]])])]),_:3}),e.searchable?(u(),d("input",{key:0,ref:"search",name:n.name,id:e.id,type:"text",autocomplete:"off",spellcheck:n.spellcheck,placeholder:e.placeholder,required:p.isRequired,style:Ce(p.inputStyle),value:e.search,disabled:n.disabled,tabindex:n.tabindex,"aria-label":n.name+"-searchbox",onInput:a[2]||(a[2]=o=>e.updateSearch(o.target.value)),onFocus:a[3]||(a[3]=O(o=>e.activate(),["prevent"])),onBlur:a[4]||(a[4]=O(o=>e.deactivate(),["prevent"])),onKeyup:a[5]||(a[5]=F(o=>e.deactivate(),["esc"])),onKeydown:[a[6]||(a[6]=F(O(o=>e.pointerForward(),["prevent"]),["down"])),a[7]||(a[7]=F(O(o=>e.pointerBackward(),["prevent"]),["up"])),a[9]||(a[9]=F(O(o=>e.removeLastElement(),["stop"]),["delete"]))],onKeypress:a[8]||(a[8]=F(O(o=>e.addPointerElement(o),["prevent","stop","self"]),["enter"])),class:"multiselect__input","aria-controls":"listbox-"+e.id},null,44,_t)):f("v-if",!0),p.isSingleLabelVisible?(u(),d("span",{key:1,class:"multiselect__single",onMousedown:a[10]||(a[10]=O((...o)=>e.toggle&&e.toggle(...o),["prevent"]))},[$(e.$slots,"singleLabel",{option:p.singleValue},()=>[M(m(e.currentOptionLabel),1)])],32)):f("v-if",!0),p.isPlaceholderVisible?(u(),d("span",{key:2,class:"multiselect__placeholder",onMousedown:a[11]||(a[11]=O((...o)=>e.toggle&&e.toggle(...o),["prevent"]))},[$(e.$slots,"placeholder",{},()=>[M(m(e.placeholder),1)])],32)):f("v-if",!0)],512),(u(),vt(mt,{to:"body",disabled:!n.useTeleport},[Ne(qe,{name:"multiselect"},{default:se(()=>[e.isOpen&&y.ready?(u(),d("div",{key:0,class:"multiselect__content-wrapper",onFocus:a[12]||(a[12]=(...o)=>e.activate&&e.activate(...o)),tabindex:"-1",onMousedown:a[13]||(a[13]=O(()=>{},["prevent"])),style:Ce([y.dropdownStyles,{maxHeight:e.optimizedHeight+"px"}]),ref:"list"},[i("ul",{class:"multiselect__content",style:Ce(p.contentStyle),role:"listbox",id:"listbox-"+e.id,"aria-multiselectable":e.multiple},[$(e.$slots,"beforeList"),e.multiple&&e.max===e.internalValue.length?(u(),d("li",Bt,[i("span",Ut,[$(e.$slots,"maxElements",{},()=>[M("Maximum of "+m(e.max)+" options selected. First remove a selected option to select another.",1)])])])):f("v-if",!0),!e.max||e.internalValue.length<e.max?(u(!0),d(x,{key:1},P(e.filteredOptions,(o,E)=>(u(),d("li",{class:"multiselect__element",key:E,"aria-selected":e.isSelected(o),id:e.id+"-"+E,role:o&&(o.$isLabel||o.$isDisabled)?null:"option"},[o&&(o.$isLabel||o.$isDisabled)?f("v-if",!0):(u(),d("span",{key:0,class:_([e.optionHighlight(E,o),"multiselect__option"]),onClick:O(T=>e.select(o),["stop"]),onMouseenter:O(T=>e.pointerSet(E),["self"]),"data-select":o&&o.isTag?e.tagPlaceholder:p.selectLabelText,"data-selected":p.selectedLabelText,"data-deselect":p.deselectLabelText},[$(e.$slots,"option",{option:o,search:e.search,index:E},()=>[i("span",null,m(e.getOptionLabel(o)),1)])],42,qt)),o&&(o.$isLabel||o.$isDisabled)?(u(),d("span",{key:1,"data-select":e.groupSelect&&p.selectGroupLabelText,"data-deselect":e.groupSelect&&p.deselectGroupLabelText,class:_([e.groupHighlight(E,o),"multiselect__option"]),onMouseenter:O(T=>e.groupSelect&&e.pointerSet(E),["self"]),onMousedown:O(T=>e.selectGroup(o),["prevent"])},[$(e.$slots,"option",{option:o,search:e.search,index:E},()=>[i("span",null,m(e.getOptionLabel(o)),1)])],42,Ft)):f("v-if",!0)],8,Pt))),128)):f("v-if",!0),A(i("li",null,[i("span",Ht,[$(e.$slots,"noResult",{search:e.search},()=>[a[20]||(a[20]=M("No elements found. Consider changing the search query."))])])],512),[[ce,n.showNoResults&&e.filteredOptions.length===0&&e.search&&!n.loading]]),A(i("li",null,[i("span",Gt,[$(e.$slots,"noOptions",{},()=>[a[21]||(a[21]=M("List is empty."))])])],512),[[ce,n.showNoOptions&&(e.options.length===0||p.hasOptionGroup===!0&&e.filteredOptions.length===0)&&!e.search&&!n.loading]]),$(e.$slots,"afterList")],12,Tt)],36)):f("v-if",!0)]),_:3})],8,["disabled"]))],42,xt)}Ge.render=zt;const jt={class:"min-h-screen bg-slate-50"},Kt={class:"sticky top-0 z-10 backdrop-blur bg-white/70 border-b border-slate-200"},Zt={class:"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between"},Xt={class:"text-slate-900 font-semibold text-lg sm:text-2xl"},Yt={class:"max-w-6xl mx-auto px-2 sm:px-4 py-6 space-y-4"},Qt={key:0,class:"text-center py-12 text-brand-700 font-semibold"},Jt={key:1,class:"text-center py-12 text-red-500"},Wt={class:"card mb-3"},el={class:"card-body grid grid-cols-1 sm:grid-cols-6 gap-3 sm:items-end"},tl=["disabled"],ll={key:0,value:"all"},sl=["value"],il={class:"sm:col-span-3"},al=["value"],nl={key:0,class:"text-xs text-slate-500 mt-1"},ol={class:"card"},rl={class:"card-body"},ul={class:"grid grid-cols-1 sm:grid-cols-6 gap-2 sm:items-end"},dl=["value"],pl={class:"flex items-center gap-2 mt-2 sm:mt-0"},cl={class:"mt-4 flex flex-wrap gap-2"},hl={class:"card"},vl={class:"card-body overflow-x-auto p-0"},ml={class:"table min-w-full text-xs sm:text-sm"},gl={key:0},fl={key:1},yl={key:2,class:"text-center"},bl={class:"font-medium text-slate-900"},Sl={key:0},Il={class:"text-slate-700"},Ol={key:1},Cl={class:"text-slate-700"},El={key:2,class:"text-slate-300"},wl={key:2,class:"text-right"},kl=["onClick"],Nl={key:3,class:"text-right"},Dl=["onClick"],xl={key:0},Al=["colspan"],Vl={class:"bg-white rounded-xl shadow max-w-2xl w-full"},Ll={class:"p-4 border-b flex items-center justify-between"},$l={class:"font-semibold text-slate-800"},Rl={class:"p-4 space-y-4"},Ml={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},_l=["value"],Tl={key:0,class:"sm:col-span-2"},Bl={class:"flex items-center justify-between w-full"},Ul={class:"text-xs text-slate-400"},Pl={key:1},ql={key:2},Fl={key:3},Hl={key:4,class:"sm:col-span-3"},Gl={key:5,class:"sm:col-span-3 text-xs text-slate-500"},zl={class:"flex justify-end gap-2 pt-2"},jl=["disabled"],Kl={key:0,class:"fixed inset-0 z-[9998] grid place-items-center p-4"},Zl={class:"relative z-10 w-full max-w-5xl rounded-2xl shadow-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-200"},Xl={class:"px-5 py-4 rounded-t-2xl text-white flex items-center justify-between bg-gradient-to-r from-slate-900 via-indigo-700 to-blue-600 dark:from-slate-950 dark:via-indigo-900 dark:to-blue-800"},Yl={class:"flex items-center gap-3"},Ql={class:"text-xl font-semibold tracking-tight"},Jl={key:0,class:"opacity-80 text-sm"},Wl={class:"inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs bg-white/15 text-white"},es={class:"px-5 py-3 flex flex-wrap items-center gap-3"},ts={class:"flex items-center gap-2"},ls={class:"inline-flex items-center gap-1 rounded-full border border-slate-300 bg-white px-3 py-1 text-xs text-slate-700 dark:bg-slate-800 dark:text-slate-200 dark:border-slate-700"},ss={class:"ml-auto inline-flex rounded-full p-1 bg-slate-200/70 dark:bg-slate-700/60"},is={class:"px-5 pb-5 max-h-[70vh] overflow-auto"},as={key:0},ns={class:"grid grid-cols-7 gap-2"},os=["title"],rs={class:"text-[11px] font-medium opacity-60"},us={key:0,class:"mt-auto text-center text-lg leading-none"},ds={key:1,class:"text-[11px] text-center truncate mt-1 opacity-85"},ps={key:1,class:"space-y-4 relative"},cs={class:"opacity-70"},hs={class:"opacity-70"},vs={key:2,class:"mt-5 flex flex-wrap gap-2 text-xs"},ms={__name:"AdminReportDetail",setup(e){const a=I([]);async function n(){try{const{data:s}=await U.get("/admin/groups",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});a.value=Array.isArray(s)?s:[]}catch{a.value=[]}}const b=D(()=>T.value&&T.value.role==="leader_group"),y=I("all"),p=ft(),o=bt(),E={id:11001,name:"BOGOTÁ, D.C.",dept:"BOGOTÁ, D.C.",label(){return`${this.name} (${this.dept})`}},T=I(null);async function ze(){try{const{data:s}=await U.get("/me",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});T.value=s}catch{T.value=null}}const J=D(()=>{const s=String(T.value?.role||"").toLowerCase();return["leader_group","superadmin","supervision","supervisor"].includes(s)}),De=D(()=>p.params.id?String(p.params.id):null),he=D(()=>p.query.date?String(p.query.date):new Date().toISOString().slice(0,10)),V=D(()=>p.query.groupId?String(p.query.groupId):null),L=D(()=>!!V.value),ve=I(!0),q=I({groupCode:"",unitName:"",date:"—"}),R=I(!1),j=I([]),xe=I([]),k=I({...{q:"",category:"ALL",state:"ALL",unitId:"ALL",onlyNovelties:!1}}),Ae=["SIN NOVEDAD","SERVICIO","COMISIÓN DEL SERVICIO","FRANCO FRANCO","VACACIONES","LICENCIA DE MATERNIDAD","LICENCIA DE LUTO","LICENCIA REMUNERADA","LICENCIA NO REMUNERADA","EXCUSA DEL SERVICIO","LICENCIA PATERNIDAD","PERMISO","COMISIÓN EN EL EXTERIOR","COMISIÓN DE ESTUDIO","SUSPENDIDO","HOSPITALIZADO"],w=I(he.value),N=I(String(p.query.unitId||"")),G=I([]);function W(){const s=new Date,t=String(s.getMonth()+1).padStart(2,"0"),l=String(s.getDate()).padStart(2,"0");return`${s.getFullYear()}-${t}-${l}`}async function ie(s){try{const t={date_from:s,date_to:s};L.value&&V.value&&(t.groupId=V.value);const{data:l}=await U.get("/dashboard/reports",{params:t,headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),c=Array.isArray(l?.items)?l.items:[],g=new Map;for(const r of c)if(r.unitId&&r.unitName){const C=String(r.unitId);g.has(C)||g.set(C,{id:C,name:r.unitName})}G.value=Array.from(g.values()).sort((r,C)=>String(r.name||"").localeCompare(String(C.name||"")));const v=String(p.query.unitId||"");if(v){if(N.value=v,!G.value.some(r=>String(r.id)===v))try{const{data:r}=await U.get(`/admin/units/${v}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});r?.id?G.value.unshift({id:String(r.id),name:r.name||`Unidad ${r.id}`}):G.value.unshift({id:v,name:`Unidad ${v}`})}catch{G.value.unshift({id:v,name:`Unidad ${v}`})}}else N.value=""}catch(t){console.error("loadUnitsIndex error",t),G.value=[]}}async function ee(s,t){try{const l=String(t??"").trim(),c=/^\d+$/.test(l)?Number(l):l,g={date_from:s,date_to:s,unitId:c};L.value&&V.value&&(g.groupId=V.value);const{data:v}=await U.get("/dashboard/reports",{params:g,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});let r=Array.isArray(v?.items)?v.items:[];if(r.length&&(r=r.filter(S=>String(S.unitId)===String(c))),!r.length){await o.replace({name:p.name,params:p.params,query:{...p.query,unitId:String(c||""),date:s}});return}const C=r.sort((S,te)=>String(S.id).localeCompare(String(te.id))).pop();await o.replace({name:p.name,params:{id:String(C.id)},query:{...p.query,unitId:String(c),date:s}}),R.value=!1,j.value=[],await ge(String(C.id)),q.value={...q.value,date:s},R.value=!0}catch(l){console.warn("gotoReportForUnit error:",l?.message||l),await o.replace({name:p.name,params:p.params,query:{...p.query,unitId:String(t||""),date:s}})}}async function je(){const s=w.value||W();await ie(s),N.value?await ee(s,N.value):(L.value&&V.value&&await Y(s,V.value),await o.replace({name:p.name,params:p.params,query:{...p.query,date:s,unitId:""}}),q.value={...q.value,date:s})}async function Ve(){const s=w.value||W(),t=N.value;if(!t){L.value&&V.value&&await Y(s,V.value),await o.replace({name:p.name,params:p.params,query:{...p.query,date:s,unitId:""}});return}await ee(s,t)}X(()=>p.query,async s=>{const t=String(s.date||W()),l=String(s.unitId||"");(t!==w.value||l!==N.value)&&(w.value=t,N.value=l,await ie(t),l?await ee(t,l):L.value&&V.value&&await Y(t,V.value))});function me(s){if(!s)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(s)){const[v,r,C]=s.split("-");return`${C}/${r}/${v}`}const t=new Date(s);if(isNaN(t))return"";const l=String(t.getDate()).padStart(2,"0"),c=String(t.getMonth()+1).padStart(2,"0"),g=t.getFullYear();return`${l}/${c}/${g}`}function Ke(s){return String(s||"").toUpperCase()==="SO"?"ME":s}const Ze={OF:1,SO:2,PT:3};function Le(s){const t=String(s||"").toUpperCase();return Ze[t]||99}function Xe(s){const t=String(s||"").toUpperCase();return t==="SIN NOVEDAD"?"bg-green-50 text-green-700 border-green-200":t==="SERVICIO"||t==="COMISIÓN DEL SERVICIO"?"bg-sky-50 text-sky-700 border-sky-200":"bg-amber-50 text-amber-800 border-amber-200"}async function ge(s){const{data:t}=await U.get(`/admin/report-agents/${s}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),l=r=>({...r,_key:`${r.code}-${r.unitName||""}-${r.state}-${r.novelty_start||""}-${r.novelty_end||""}`,municipality:r.municipalityName&&r.dept?`${r.municipalityName} (${r.dept})`:r.municipalityName||"",municipalityName:r.municipalityName||null,municipalityDept:r.dept||null,municipalityId:r.municipalityId!=null?Number(r.municipalityId):null,novelty_description:r.novelty_description||r.descripcion,reportId:s}),c=(Array.isArray(t)?t:[]).map(l);j.value=c;const g=c[0],v=w.value||he.value;q.value={groupCode:g?.groupCode||"",unitName:g?.unitName||"",date:v},R.value=!0}async function Y(s,t){const{data:l}=await U.get("/dashboard/reports",{params:{date_from:s,date_to:s,groupId:t},headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),c=Array.isArray(l?.items)?l.items:[];if(!c.length){R.value=!1;return}q.value={groupCode:c[0].groupCode,unitName:"",date:s},xe.value=[...new Map(c.map(v=>[String(v.unitName||""),{id:v.unitId,name:v.unitName}])).values()].filter(v=>!!v.id).sort((v,r)=>(v.name||"").localeCompare(r.name||""));const g=[];for(const v of c){const{data:r}=await U.get(`/admin/report-agents/${v.id}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),C=(Array.isArray(r)?r:[]).map(S=>({...S,_key:`${S.code}-${S.unitName||""}-${S.state}-${S.novelty_start||""}-${S.novelty_end||""}`,municipality:S.municipalityName&&S.dept?`${S.municipalityName} (${S.dept})`:S.municipalityName||"",municipalityName:S.municipalityName||null,municipalityDept:S.dept||null,municipalityId:S.municipalityId!=null?Number(S.municipalityId):null,novelty_description:S.novelty_description||S.descripcion,reportId:v.id}));g.push(...C)}j.value=g,R.value=!0}const ae=D(()=>{let s=j.value.slice();const t=k.value.q.trim().toUpperCase();if(t&&(s=s.filter(l=>String(l.code||"").toUpperCase().includes(t)||String(l.novelty_description||"").toUpperCase().includes(t)||String(l.unitName||"").toUpperCase().includes(t))),k.value.category!=="ALL"&&(s=s.filter(l=>String(l.category)===k.value.category)),k.value.state!=="ALL"&&(s=s.filter(l=>String(l.state).toUpperCase()===k.value.state)),k.value.onlyNovelties&&(s=s.filter(l=>String(l.state).toUpperCase()!=="SIN NOVEDAD")),L.value&&k.value.unitId!=="ALL"){const l=xe.value.find(c=>String(c.id)===String(k.value.unitId))?.name||"";s=s.filter(c=>String(c.unitName||"")===l)}return s.sort((l,c)=>{const g=Le(l.category),v=Le(c.category);return g!==v?g-v:String(l.code).localeCompare(String(c.code))})}),Ye=D(()=>{const s={"SIN NOVEDAD":0,SERVICIO:0,"COMISIÓN DEL SERVICIO":0,otros:0};for(const t of ae.value){const l=String(t.state).toUpperCase();l==="SIN NOVEDAD"?s["SIN NOVEDAD"]++:l==="SERVICIO"?s.SERVICIO++:l==="COMISIÓN DEL SERVICIO"?s["COMISIÓN DEL SERVICIO"]++:s.otros++}return[{key:"sn",label:"Sin novedad",count:s["SIN NOVEDAD"],cls:"bg-green-50 text-green-700 border-green-200",dot:"bg-green-600"},{key:"srv",label:"Servicio",count:s.SERVICIO,cls:"bg-sky-50 text-sky-700 border-sky-200",dot:"bg-sky-600"},{key:"cds",label:"Comisión del servicio",count:s["COMISIÓN DEL SERVICIO"],cls:"bg-sky-50 text-sky-700 border-sky-200",dot:"bg-sky-600"},{key:"oth",label:"Otros",count:s.otros,cls:"bg-amber-50 text-amber-800 border-amber-200",dot:"bg-amber-600"}]}),fe=I(!1),z=I(null),ne=I(!1),h=I({state:"SIN NOVEDAD",municipio:null,novelty_start:"",novelty_end:"",novelty_description:""}),ye=D(()=>["SERVICIO","VACACIONES","LICENCIA DE MATERNIDAD","LICENCIA DE LUTO","LICENCIA REMUNERADA","LICENCIA NO REMUNERADA","EXCUSA DEL SERVICIO","LICENCIA PATERNIDAD","PERMISO","COMISIÓN EN EL EXTERIOR","COMISIÓN DE ESTUDIO","SUSPENDIDO"].includes(h.value.state)),$e=D(()=>["SERVICIO","VACACIONES","LICENCIA DE MATERNIDAD","LICENCIA DE LUTO","LICENCIA REMUNERADA","LICENCIA NO REMUNERADA","EXCUSA DEL SERVICIO","LICENCIA PATERNIDAD","PERMISO","COMISIÓN EN EL EXTERIOR","COMISIÓN DE ESTUDIO","COMISIÓN DEL SERVICIO","SUSPENDIDO","HOSPITALIZADO"].includes(h.value.state)),Qe=D(()=>h.value.state==="COMISIÓN DEL SERVICIO");function Je(s){if(!J.value)return;z.value=s;const t=String(s.state||"").toUpperCase(),l=t==="COMISIÓN DEL SERVICIO";let c=null;if(l){const g=s.municipalityId!=null?Number(s.municipalityId):null,v=s.municipalityName||null,r=s.municipalityDept||null;g&&(c=Re(g,v,r))}h.value={state:t,municipio:c,novelty_start:s.novelty_start||"",novelty_end:s.novelty_end||"",novelty_description:s.novelty_description||""},fe.value=!0}X(()=>h.value.state,s=>{if(String(s||"").toUpperCase()!=="COMISIÓN DEL SERVICIO")h.value.municipio=null;else{const l=z.value;l?.municipalityId&&!h.value.municipio&&(h.value.municipio=Re(l.municipalityId,l.municipalityName,l.municipalityDept))}});function oe(){fe.value=!1,z.value=null}const K=I([]),be=I(!1);let Se=null;async function We(s){Se&&clearTimeout(Se),Se=setTimeout(async()=>{const t=String(s||"").trim();if(t.length<2){K.value=[];return}be.value=!0;try{const{data:l}=await U.get("/catalogs/municipalities",{params:{q:t,limit:15},headers:{Authorization:"Bearer "+localStorage.getItem("token")}});K.value=(l||[]).map(c=>({id:c.id,label:`${c.name} (${c.dept})`}))}catch{K.value=[]}finally{be.value=!1}},250)}function Re(s,t,l){if(!s)return null;const c=Number(s);let g=K.value.find(v=>Number(v.id)===c);return g||(g={id:c,label:t?`${t} (${l||""})`:`id ${c}`},K.value=[g,...K.value]),g}async function et(){if(z.value){if(h.value.state==="COMISIÓN DEL SERVICIO"&&!h.value.municipio?.id){alert("Selecciona un municipio para Comisión del servicio");return}if(h.value.state==="COMISIÓN DEL SERVICIO"&&!h.value.novelty_description?.trim()){alert("La descripción es requerida para Comisión del servicio");return}if(h.value.state==="HOSPITALIZADO"){if(!h.value.novelty_start){alert("Falta fecha de inicio (HOSPITALIZADO)");return}if(!h.value.novelty_description?.trim()){alert("Falta descripción (HOSPITALIZADO)");return}}if(ye.value&&(!h.value.novelty_start||!h.value.novelty_end)){alert("Completa las fechas de la novedad (inicio y fin)");return}if($e.value&&!h.value.novelty_description?.trim()){alert("La descripción es requerida para este estado");return}ne.value=!0;try{const s=h.value.state==="HOSPITALIZADO";await U.put(`/admin/report-agents/${z.value.reportId}/${z.value.agentId}`,{state:h.value.state,municipalityId:h.value.state==="COMISIÓN DEL SERVICIO"?h.value.municipio?.id||null:["SERVICIO","SIN NOVEDAD"].includes(h.value.state)?E.id:null,novelty_start:h.value.novelty_start||null,novelty_end:s?null:h.value.novelty_end||null,novelty_description:h.value.novelty_description||null},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});let t=null,l=null,c=null,g="";if(h.value.state==="COMISIÓN DEL SERVICIO"){if(t=h.value.municipio?.id||null,h.value.municipio?.label){const v=h.value.municipio.label.split(" (");l=v[0]||null,c=v[1]?v[1].replace(/\)$/,""):null,g=h.value.municipio.label}}else["SERVICIO","SIN NOVEDAD"].includes(h.value.state)&&(t=E.id,l=E.name,c=E.dept,g=E.label());Object.assign(z.value,{state:h.value.state,municipalityId:t,municipalityName:l,municipalityDept:c,municipality:g||(l?`${l} (${c||""})`:"N/A"),novelty_start:h.value.novelty_start||null,novelty_end:s?null:h.value.novelty_end||null,novelty_description:h.value.novelty_description||null}),oe()}catch(s){alert(s?.response?.data?.detail||s?.response?.data?.error||"No se pudo guardar")}finally{ne.value=!1}}}async function tt(){const s=ae.value.map(g=>({codigo:g.code,categoria:g.category,unidad:g.unitName||"",estado:g.state,ubicacion:g.municipality||"",descripcion:g.novelty_description||"",fecha_inicio:g.novelty_start?String(g.novelty_start).slice(0,10):"",fecha_fin:g.novelty_end?String(g.novelty_end).slice(0,10):""})),t=Ee.json_to_sheet(s),l=Ee.book_new();Ee.book_append_sheet(l,t,"Detalle");const c=Ot(l,{bookType:"xlsx",type:"array"});Ct.saveAs(new Blob([c],{type:"application/octet-stream"}),`detalle_${q.value.groupCode}_${q.value.date}.xlsx`)}yt(async()=>{ve.value=!0,await ze(),await n();const s=p.query.groupId?String(p.query.groupId):b.value&&a.value[0]?String(a.value[0].id):"all";y.value=s;try{const t=String(p.query.date||""),l=String(p.query.unitId||"");w.value=t||he.value,N.value=l,await ie(w.value),N.value&&w.value?await ee(w.value,N.value):L.value&&V.value?await Y(w.value,V.value):De.value?(await ge(De.value),q.value={...q.value,date:w.value}):R.value=!1,b.value&&a.value.length&&(y.value=String(a.value[0].id))}catch{R.value=!1}finally{ve.value=!1}}),X(()=>p.params.id,async(s,t)=>{if(s&&s!==t){R.value=!1,j.value=[];try{await ge(String(s))}finally{R.value=!0}}}),X(N,async(s,t)=>{s!==t&&await Ve()}),X(()=>p.query.unitId,async(s,t)=>{if(s!==t){const l=String(p.query.date||w.value);N.value=String(s||""),N.value?await ee(l,N.value):L.value&&V.value&&(R.value=!1,j.value=[],await Y(l,V.value),R.value=!0)}}),X(y,async(s,t)=>{s!==t&&(await o.replace({name:p.name,params:p.params,query:{...p.query,groupId:s==="all"?void 0:s,unitId:""}}),await ie(w.value),s!=="all"?await Y(w.value,s):(j.value=[],R.value=!1))}),X(()=>p.query.groupId,s=>{s&&String(y.value)!==String(s)&&(y.value=String(s)),!s&&y.value!=="all"&&(y.value="all")});const H=I({open:!1,agent:null}),Z=I("calendar"),re=I([]),B=I(new Date);function ue(s){return s.toISOString().slice(0,10)}function Me(s){const t=new Date(s);return t.setDate(1),t.setHours(0,0,0,0),t}function _e(s){const t=new Date(s);return t.setMonth(t.getMonth()+1,0),t.setHours(0,0,0,0),t}function Te(s,t){const l=new Date(s);return l.setMonth(l.getMonth()+t),l}function lt(s){return new Intl.DateTimeFormat("es-CO",{month:"long",year:"numeric"}).format(s)}function st(s){return(s.getDay()+6)%7}const Be=D(()=>ue(Me(B.value))),Ue=D(()=>ue(_e(B.value))),it=D(()=>lt(B.value));function at(){B.value=Te(B.value,-1),pe()}function nt(){B.value=Te(B.value,1),pe()}function ot(){B.value=new Date((w.value||W())+"T00:00:00"),pe()}function Ie(s){const t=String(s||"").toUpperCase();return{"SIN NOVEDAD":"✅",SERVICIO:"🧭","COMISIÓN DEL SERVICIO":"📌","FRANCO FRANCO":"🛌",VACACIONES:"🏖️","LICENCIA DE MATERNIDAD":"👶","LICENCIA DE LUTO":"🕊️","LICENCIA REMUNERADA":"📝","LICENCIA NO REMUNERADA":"📝","EXCUSA DEL SERVICIO":"📝","LICENCIA PATERNIDAD":"🍼",PERMISO:"⏳","COMISIÓN EN EL EXTERIOR":"✈️","COMISIÓN DE ESTUDIO":"🎓",SUSPENDIDO:"⛔",HOSPITALIZADO:"🏥"}[t]||"•"}function de(s){const t=String(s||"").toUpperCase();return{"SIN NOVEDAD":{bg:"bg-emerald-100",pill:"bg-emerald-100 text-emerald-800",dot:"bg-emerald-500"},SERVICIO:{bg:"bg-sky-100",pill:"bg-sky-100 text-sky-800",dot:"bg-sky-500"},"COMISIÓN DEL SERVICIO":{bg:"bg-indigo-100",pill:"bg-indigo-100 text-indigo-800",dot:"bg-indigo-500"},"FRANCO FRANCO":{bg:"bg-gray-100",pill:"bg-gray-100 text-gray-800",dot:"bg-gray-500"},VACACIONES:{bg:"bg-amber-100",pill:"bg-amber-100 text-amber-800",dot:"bg-amber-500"},SUSPENDIDO:{bg:"bg-rose-100",pill:"bg-rose-100 text-rose-800",dot:"bg-rose-500"},HOSPITALIZADO:{bg:"bg-rose-100",pill:"bg-rose-100 text-rose-800",dot:"bg-rose-500"}}[t]||{bg:"bg-slate-100",pill:"bg-slate-100 text-slate-700",dot:"bg-slate-400"}}function Pe(s){return s=String(s||""),s.length<=16?s:s.slice(0,16)+"…"}const rt=["SIN NOVEDAD","SERVICIO","COMISIÓN DEL SERVICIO","VACACIONES","FRANCO FRANCO","SUSPENDIDO","HOSPITALIZADO"];async function ut(s){const t=s.agentId??s.id;t&&(H.value={open:!0,agent:{id:t,code:s.code,nickname:s.nickname}},Z.value="calendar",B.value=new Date((w.value||W())+"T00:00:00"),await pe())}async function pe(){if(H.value.agent)try{const{data:s}=await U.get(`/admin/agents/${H.value.agent.id}/history`,{params:{from:Be.value,to:Ue.value},headers:{Authorization:"Bearer "+localStorage.getItem("token")}});re.value=Array.isArray(s?.items)?s.items:[]}catch(s){console.warn("No se pudo cargar historial:",s?.response?.data?.error||s.message),re.value=[]}}const dt=D(()=>{const s=Me(B.value),t=_e(B.value),l=st(s),c=t.getDate(),g=new Map(re.value.map(r=>[String(r.date),r])),v=[];for(let r=0;r<l;r++)v.push({key:"pad-"+r,day:"",state:null,title:""});for(let r=1;r<=c;r++){const C=new Date(s);C.setDate(r);const S=ue(C),te=g.get(S),Oe=te?.state||null,ct=Oe?`${S} — ${Oe}${te?.municipalityName?" — "+te.municipalityName:""}`:S,ht=S===ue(new Date);v.push({key:S,day:r,state:Oe,title:ct,isToday:ht})}for(;v.length%7;)v.push({key:"tail-"+v.length,day:"",state:null,title:""});return v}),pt=D(()=>{const s=[...re.value].sort((l,c)=>String(l.date).localeCompare(String(c.date))),t=[];for(const l of s){const c=l.state||"SIN NOVEDAD",g=String(c).toUpperCase()==="COMISIÓN DEL SERVICIO",v=g?l.municipalityName||"—":null,r=g?`${c}::${v}`:c,C=t[t.length-1];C&&C.key===r?(C.to=l.date,C.count+=1):t.push({key:r,state:c,municipalityName:v,from:l.date,to:l.date,count:1})}return t});return(s,t)=>(u(),d(x,null,[i("div",jt,[i("header",Kt,[i("div",Zt,[i("h1",Xt,m(L.value?"Detalle de reporte del grupo":"Detalle de reporte de unidad"),1),i("button",{onClick:t[0]||(t[0]=l=>Fe(o).back()),class:"btn-ghost"},"Volver")])]),i("main",Yt,[ve.value?(u(),d("div",Qt,"Cargando...")):R.value?(u(),d(x,{key:2},[i("div",Wt,[i("div",el,[i("div",null,[t[18]||(t[18]=i("label",{class:"label"},"Fecha",-1)),A(i("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=l=>w.value=l),class:"input",onChange:je},null,544),[[Q,w.value]])]),i("div",null,[t[19]||(t[19]=i("label",{class:"label"},"Grupo",-1)),A(i("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>y.value=l),class:"input",disabled:b.value},[b.value?f("",!0):(u(),d("option",ll,"Todos")),(u(!0),d(x,null,P(a.value,l=>(u(),d("option",{key:l.id,value:String(l.id)},m(l.code)+" ("+m(l.name)+") ",9,sl))),128))],8,tl),[[le,y.value]])]),i("div",il,[t[21]||(t[21]=i("label",{class:"label"},"Unidad",-1)),A(i("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>N.value=l),class:"input",onChange:Ve},[t[20]||(t[20]=i("option",{value:""},"Todas las unidades…",-1)),(u(!0),d(x,null,P(G.value,l=>(u(),d("option",{key:l.id,value:String(l.id)},m(l.name),9,al))),128))],544),[[le,N.value]]),G.value.length?f("",!0):(u(),d("p",nl," No hay unidades para la fecha seleccionada. "))])])]),i("div",ol,[i("div",rl,[i("div",ul,[i("div",null,[t[22]||(t[22]=i("label",{class:"label"},"Búsqueda",-1)),A(i("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>k.value.q=l),class:"input",placeholder:"Código o texto…"},null,512),[[Q,k.value.q]])]),i("div",null,[t[24]||(t[24]=i("label",{class:"label"},"Categoría",-1)),A(i("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>k.value.category=l),class:"input"},t[23]||(t[23]=[i("option",{value:"ALL"},"Todas",-1),i("option",{value:"OF"},"OF",-1),i("option",{value:"SO"},"ME",-1),i("option",{value:"PT"},"PT",-1)]),512),[[le,k.value.category]])]),i("div",null,[t[26]||(t[26]=i("label",{class:"label"},"Estado",-1)),A(i("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>k.value.state=l),class:"input"},[t[25]||(t[25]=i("option",{value:"ALL"},"Todos",-1)),(u(),d(x,null,P(Ae,l=>i("option",{key:l,value:l},m(l),9,dl)),64))],512),[[le,k.value.state]])]),i("div",pl,[A(i("input",{id:"solo-nov",type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=l=>k.value.onlyNovelties=l),class:"h-4 w-4"},null,512),[[St,k.value.onlyNovelties]]),t[27]||(t[27]=i("label",{class:"label cursor-pointer",for:"solo-nov"},"Solo novedades",-1))]),i("div",{class:"flex gap-2"},[i("button",{class:"flex-1 sm:flex-none inline-flex items-center justify-center rounded-lg px-3 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700",onClick:tt},"Descargar")])]),i("div",cl,[(u(!0),d(x,null,P(Ye.value,l=>(u(),d("span",{key:l.key,class:_(["inline-flex items-center gap-2 px-3 py-1 rounded-full border text-sm",l.cls])},[i("span",{class:_(["inline-block w-2.5 h-2.5 rounded-full",l.dot])},null,2),M(" "+m(l.label)+": ",1),i("b",null,m(l.count),1)],2))),128))])])]),i("div",hl,[i("div",vl,[i("table",ml,[i("thead",null,[i("tr",null,[t[28]||(t[28]=i("th",null,"Código",-1)),t[29]||(t[29]=i("th",null,"Agente",-1)),t[30]||(t[30]=i("th",null,"Categoría",-1)),L.value?(u(),d("th",gl,"Grupo")):f("",!0),L.value?(u(),d("th",fl,"Unidad")):f("",!0),t[31]||(t[31]=i("th",null,"Estado",-1)),t[32]||(t[32]=i("th",null,"Ubicación",-1)),t[33]||(t[33]=i("th",null,"Descripción",-1)),t[34]||(t[34]=i("th",null,"Novedad (inicio - fin)",-1)),t[35]||(t[35]=i("th",null,"Historial",-1)),J.value?(u(),d("th",yl,"Acciones")):f("",!0)])]),i("tbody",null,[(u(!0),d(x,null,P(ae.value,l=>(u(),d("tr",{key:l._key},[i("td",bl,m(l.code),1),i("td",null,m(l.nickname||"—"),1),i("td",null,m(Ke(l.category)),1),L.value?(u(),d("td",Sl,[i("span",Il,m(l.groupCode||"—"),1)])):f("",!0),L.value?(u(),d("td",Ol,[i("span",Cl,m(l.unitName||"—"),1)])):f("",!0),i("td",null,[i("span",{class:_(["inline-flex px-2 py-0.5 rounded-full text-xs font-semibold border",Xe(l.state)])},m(l.state),3)]),i("td",null,m(l.municipality||"N/A"),1),i("td",null,m(l.novelty_description||"—"),1),i("td",null,[l.novelty_start&&l.novelty_end?(u(),d(x,{key:0},[M(m(me(l.novelty_start))+" – "+m(me(l.novelty_end)),1)],64)):l.novelty_start?(u(),d(x,{key:1},[M(m(me(l.novelty_start)),1)],64)):(u(),d("span",El,"—"))]),J.value?(u(),d("td",wl,[i("button",{class:"btn-ghost p-1",title:"Historial",onClick:c=>ut(l)},t[36]||(t[36]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[i("path",{d:"M12 8v4l3 3"}),i("circle",{cx:"12",cy:"12",r:"9"})],-1)]),8,kl)])):f("",!0),J.value?(u(),d("td",Nl,[i("button",{class:"btn-ghost p-1",title:"Editar",onClick:c=>Je(l)},t[37]||(t[37]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[i("path",{d:"M18 2a2.828 2.828 0 0 1 4 4L7 21l-4 1 1-4Z"}),i("path",{d:"m16 5 3 3"})],-1)]),8,Dl)])):f("",!0)]))),128)),ae.value.length?f("",!0):(u(),d("tr",xl,[i("td",{colspan:J.value?L.value?8:7:L.value?7:6,class:"text-center text-slate-500 py-6"},"Sin agentes",8,Al)]))])])])]),fe.value?(u(),d("div",{key:0,class:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center p-4",onClick:O(oe,["self"])},[i("div",Vl,[i("div",Ll,[i("div",$l," Editar agente — "+m(z.value?.code),1),i("button",{class:"btn-ghost",onClick:oe},"Cerrar")]),i("div",Rl,[i("div",Ml,[i("div",null,[t[38]||(t[38]=i("label",{class:"label"},"Estado",-1)),A(i("select",{"onUpdate:modelValue":t[8]||(t[8]=l=>h.value.state=l),class:"input"},[(u(),d(x,null,P(Ae,l=>i("option",{key:l,value:l},m(l),9,_l)),64))],512),[[le,h.value.state]])]),Qe.value?(u(),d("div",Tl,[t[40]||(t[40]=i("label",{class:"label"},"Municipio",-1)),Ne(Fe(Ge),{modelValue:h.value.municipio,"onUpdate:modelValue":t[9]||(t[9]=l=>h.value.municipio=l),options:K.value,loading:be.value,"internal-search":!1,"clear-on-select":!0,"close-on-select":!0,"preserve-search":!0,"show-labels":!1,"allow-empty":!0,placeholder:"Escribe para buscar…",label:"label","track-by":"id",onSearchChange:We,class:"w-full"},{noResult:se(()=>t[39]||(t[39]=[M("Ningún municipio encontrado",-1)])),option:se(({option:l})=>[i("div",Bl,[i("span",null,m(l.label),1),i("span",Ul,"id: "+m(l.id),1)])]),singleLabel:se(({option:l})=>[i("span",null,m(l.label),1)]),_:1},8,["modelValue","options","loading"]),t[41]||(t[41]=i("div",{class:"text-xs text-slate-500 mt-1"},null,-1))])):f("",!0),ye.value?(u(),d("div",Pl,[t[42]||(t[42]=i("label",{class:"label"},"Inicio",-1)),A(i("input",{"onUpdate:modelValue":t[10]||(t[10]=l=>h.value.novelty_start=l),type:"date",class:"input"},null,512),[[Q,h.value.novelty_start]])])):f("",!0),ye.value?(u(),d("div",ql,[t[43]||(t[43]=i("label",{class:"label"},"Fin",-1)),A(i("input",{"onUpdate:modelValue":t[11]||(t[11]=l=>h.value.novelty_end=l),type:"date",class:"input"},null,512),[[Q,h.value.novelty_end]])])):h.value.state==="HOSPITALIZADO"?(u(),d("div",Fl,[t[44]||(t[44]=i("label",{class:"label"},"Inicio",-1)),A(i("input",{"onUpdate:modelValue":t[12]||(t[12]=l=>h.value.novelty_start=l),type:"date",class:"input"},null,512),[[Q,h.value.novelty_start]])])):f("",!0),$e.value?(u(),d("div",Hl,[t[45]||(t[45]=i("label",{class:"label"},"Descripción",-1)),A(i("textarea",{"onUpdate:modelValue":t[13]||(t[13]=l=>h.value.novelty_description=l),class:"input",rows:"2",placeholder:"Motivo / detalle..."},null,512),[[Q,h.value.novelty_description]])])):f("",!0),h.value.state==="SERVICIO"?(u(),d("div",Gl," Para “SERVICIO” el municipio se fija automáticamente en Bogotá (11001). ")):f("",!0)]),i("div",zl,[i("button",{class:"btn-ghost",onClick:oe},"Cancelar"),i("button",{class:"btn-primary",onClick:et,disabled:ne.value},m(ne.value?"Guardando...":"Guardar"),9,jl)])])])])):f("",!0)],64)):(u(),d("div",Jt,"No se encontró información para los parámetros."))])]),H.value.open?(u(),d("div",Kl,[i("div",{class:"absolute inset-0 bg-black/40",onClick:t[14]||(t[14]=l=>H.value.open=!1)}),i("div",Zl,[i("div",Xl,[i("div",Yl,[i("div",Ql,[M(" Historial — "+m(H.value.agent?.code)+" ",1),H.value.agent?.nickname?(u(),d("span",Jl,"("+m(H.value.agent.nickname)+")",1)):f("",!0)]),i("span",Wl,m(it.value),1)]),i("button",{class:"inline-flex items-center justify-center rounded-lg px-3 py-2 text-sm font-medium text-white hover:bg-white/10",onClick:t[15]||(t[15]=l=>H.value.open=!1)},"✕")]),i("div",es,[i("div",ts,[i("button",{class:"inline-flex items-center justify-center rounded-lg px-3 py-2 text-sm bg-white border border-slate-300 hover:bg-slate-50 dark:bg-slate-800 dark:border-slate-700 dark:hover:bg-slate-700",onClick:at},"◀"),i("button",{class:"inline-flex items-center justify-center rounded-lg px-3 py-2 text-sm bg-white border border-slate-300 hover:bg-slate-50 dark:bg-slate-800 dark:border-slate-700 dark:hover:bg-slate-700",onClick:ot},"Hoy"),i("button",{class:"inline-flex items-center justify-center rounded-lg px-3 py-2 text-sm bg-white border border-slate-300 hover:bg-slate-50 dark:bg-slate-800 dark:border-slate-700 dark:hover:bg-slate-700",onClick:nt},"▶"),i("span",ls,m(Be.value)+" → "+m(Ue.value),1)]),i("div",ss,[i("button",{class:_(["px-3 py-1.5 text-sm rounded-full",Z.value==="calendar"?"bg-white shadow-sm text-slate-900 dark:bg-slate-900 dark:text-white":"text-slate-700 dark:text-slate-200"]),onClick:t[16]||(t[16]=l=>Z.value="calendar")},"Calendario",2),i("button",{class:_(["px-3 py-1.5 text-sm rounded-full",Z.value==="timeline"?"bg-white shadow-sm text-slate-900 dark:bg-slate-900 dark:text-white":"text-slate-700 dark:text-slate-200"]),onClick:t[17]||(t[17]=l=>Z.value="timeline")},"Línea de tiempo",2)])]),i("div",is,[Z.value==="calendar"?(u(),d("div",as,[t[46]||(t[46]=It('<div class="grid grid-cols-7 gap-2 text-xs font-medium text-slate-600 mb-1" data-v-360d19fc><div class="text-center" data-v-360d19fc>L</div><div class="text-center" data-v-360d19fc>M</div><div class="text-center" data-v-360d19fc>X</div><div class="text-center" data-v-360d19fc>J</div><div class="text-center" data-v-360d19fc>V</div><div class="text-center" data-v-360d19fc>S</div><div class="text-center" data-v-360d19fc>D</div></div>',1)),i("div",ns,[(u(!0),d(x,null,P(dt.value,l=>(u(),d("div",{key:l.key,title:l.title,class:_(["h-20 rounded-xl p-2 flex flex-col transition-all border border-slate-200 dark:border-slate-700 hover:shadow-md hover:-translate-y-[1px]",[l.state?de(l.state)?.bg||"bg-slate-100":"bg-white dark:bg-slate-400/60",l.isToday&&"ring-2 ring-blue-500/70"]])},[i("div",rs,m(l.day||""),1),l.state?(u(),d("div",us,m(Ie(l.state)),1)):f("",!0),l.state?(u(),d("div",ds,m(Pe(l.state)),1)):f("",!0)],10,os))),128))])])):(u(),d("div",ps,[t[47]||(t[47]=i("div",{class:"absolute left-3 top-0 bottom-0 w-px bg-gradient-to-b from-slate-300 via-slate-200 to-slate-300 dark:from-slate-700 dark:via-slate-800 dark:to-slate-700"},null,-1)),(u(!0),d(x,null,P(pt.value,(l,c)=>(u(),d("div",{key:c,class:"flex items-center gap-3 pl-4"},[i("div",{class:_(["w-3 h-3 rounded-full border-2 border-white shadow ring-1 ring-slate-200 dark:border-slate-900",de(l.state)?.dot||"bg-slate-400"])},null,2),i("div",{class:_(["inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs shadow-sm",de(l.state)?.pill||"bg-slate-100 text-slate-700"])},[M(m(Ie(l.state))+" ",1),i("span",null,[M(m(l.state)+" ",1),l.municipalityName?(u(),d(x,{key:0},[M(" — 📍 "+m(l.municipalityName),1)],64)):f("",!0)]),i("span",cs,"("+m(l.from)+" → "+m(l.to)+")",1),i("span",hs,"• "+m(l.count)+" día(s)",1)],2)]))),128))])),Z.value==="calendar"?(u(),d("div",vs,[(u(),d(x,null,P(rt,l=>i("div",{key:l,class:_(["inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs shadow-sm",de(l)?.pill||"bg-slate-100 text-slate-700"])},m(Ie(l))+" "+m(Pe(l)),3)),64))])):f("",!0)])])])):f("",!0)],64))}},ys=gt(ms,[["__scopeId","data-v-360d19fc"]]);export{ys as default};
